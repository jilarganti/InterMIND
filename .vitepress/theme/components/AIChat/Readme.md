# Компоненты чат-интерфейса Golden Fish

Чат-интерфейс построен на модульной архитектуре, которая обеспечивает адаптивность к различным устройствам и четкое разделение ответственности между компонентами.

## Структура проекта

```
.vitepress/
└── theme/
    ├── components/
    │   └── AIChat/
    │       ├── AIChat.vue             # Единая точка входа - определяет тип устройства
    │       ├── ChatContainer.vue      # Контейнер для чата и заголовка
    │       ├── ChatFooter.vue         # Поле ввода и кнопки отправки
    │       ├── ChatHeader.vue         # Заголовок чата с возможностью редактирования
    │       ├── ChatList.vue           # Список чатов с группировкой и поиском
    │       ├── ChatThread.vue         # Отображение потока сообщений
    │       ├── DesktopChatLayout.vue  # Трехколоночный макет для ПК
    │       ├── MobileChatLayout.vue   # Мобильный макет с навигацией
    │       ├── QuickPrompts.vue       # Панель быстрых подсказок
    │       └── Readme.md              # Документация
    ├── composables/
    │   └── AIChat/
    │       ├── useChatLayout.ts       # Определение типа устройства и навигация
    │       ├── useChatManagement.ts   # Управление чатами и их метаданными
    │       ├── useChatTitle.ts        # Редактирование заголовков чатов
    │       ├── useChatUi.ts           # Утилиты UI (рендеринг, скролл, клики)
    │       └── useQuickPrompts.ts     # Управление быстрыми подсказками
    ├── stores/
    │   └── chatsStore.ts             # Хранилище для управления чатами
    └── utils/
        └── chatUtils.ts              # Утилиты для обработки данных чата
```

## Архитектура и поток данных

### Основные компоненты

1. **AIChat.vue** - Единая точка входа

   - Определяет тип устройства (мобильный/десктопный)
   - Выбирает соответствующий макет для отображения
   - Инициализирует общие ресурсы (хранилище)

2. **DesktopChatLayout.vue** - Макет для ПК

   - Трехколоночный интерфейс:
     - Список чатов
     - Основной чат
     - Быстрые подсказки

3. **MobileChatLayout.vue** - Макет для мобильных устройств

   - Переключение между экранами:
     - Главный экран с быстрыми подсказками
     - Список чатов
     - Экран чата

4. **ChatContainer.vue** - Контейнер для чата

   - Содержит заголовок (ChatHeader) и поток сообщений (ChatThread)
   - Управляет редактированием заголовка
   - Экспортирует методы для вставки текста и отправки сообщений

5. **ChatThread.vue** - Отображение сообщений

   - Управляет потоком сообщений
   - Интеграция с AI SDK
   - Обработка интерактивных элементов
   - Интеграция с ChatFooter для ввода

6. **ChatFooter.vue** - Поле ввода и кнопки
   - Ввод сообщений пользователем
   - Кнопки отправки и остановки
   - Режим отладки (при разработке)

### Вспомогательные компоненты

7. **ChatList.vue** - Список чатов

   - Отображение списка чатов с группировкой
   - Поддержка поиска
   - Создание новых чатов

8. **ChatHeader.vue** - Заголовок чата

   - Отображение и редактирование заголовка
   - Кнопка возврата (в мобильном режиме)

9. **QuickPrompts.vue** - Быстрые подсказки
   - Отображение списка быстрых подсказок
   - Адаптация для разных макетов

## Поток данных

1. `AIChat` → Определяет устройство → Выбирает макет (`Desktop/MobileChatLayout`)
2. Макет → Инициализирует composables → Отображает компоненты
3. `ChatContainer` → Управляет заголовком и содержимым → Содержит `ChatThread`
4. `ChatThread` → Управляет сообщениями → Интегрируется с AI SDK и `ChatFooter`
5. `ChatFooter` → Обрабатывает ввод → Отправляет данные в `ChatThread`

## Состояние данных

Состояние хранится на трех уровнях:

1. **Хранилище чатов (chatsStore)**

   - Список ID чатов
   - Метаданные чатов (заголовки, даты)
   - История сообщений
   - Сохранение в localStorage

2. **Composables (переиспользуемая логика)**

   - `useChatManagement` - управление списком чатов
   - `useChatTitle` - редактирование заголовков
   - `useQuickPrompts` - управление быстрыми подсказками

3. **Компоненты (локальное состояние)**
   - Состояние UI (активные вкладки, тип устройства)
   - Временные данные ввода

## Адаптивность

- **Определение устройства:** `AIChat.vue` автоматически определяет тип устройства по ширине экрана
- **Адаптивные макеты:** Отдельные компоненты для мобильных и десктопных устройств
- **Поддержка планшетов:** Промежуточные стили для планшетов (скрытие правой колонки)

## Принципы разработки

Разработка чат-интерфейса следует принципам:

- **KISS (Keep It Simple, Stupid)** - Простые компоненты с четкой ответственностью
- **DRY (Don't Repeat Yourself)** - Переиспользование логики через composables
- **YAGNI (You Aren't Gonna Need It)** - Только необходимые функции
- **Изоляция стилей** - Каждый компонент имеет собственные scoped стили

## Интеграция в проект

1. Разместить компоненты в `.vitepress/theme/components/AIChat/`
2. Разместить composables в `.vitepress/theme/composables/AIChat/`
3. Подключить основной компонент в нужном месте:

```html
<AIChat />
```

4. При необходимости добавить глобальные стили в `.vitepress/theme/index.ts`:

```typescript
import "./AIChat.css"
```
