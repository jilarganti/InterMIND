# Релевантные изображения в AI чате - Руководство

## Что изменилось

Теперь AI чат InterMIND может находить и использовать релевантные изображения из самой документации вместо поиска только внешних изображений.

## Как это работает

### 1. Индексация изображений
- Скрипт `indexDocs.ts` теперь извлекает информацию об изображениях из markdown файлов
- Для каждого изображения сохраняется:
  - Исходный путь (`src`)
  - Альтернативный текст (`alt`) 
  - Контекст (окружающий текст)
  - Относительный URL для сайта (`relativeUrl`)

### 2. Поиск с изображениями
- Семантический поиск (`aiChatLib.ts`) теперь включает информацию об изображениях в результаты
- Метаданные векторов содержат:
  - `images`: JSON-массив с информацией об изображениях
  - `has_images`: булево значение наличия изображений
  - `image_count`: количество изображений
  - `first_image_url`: URL первого изображения (для быстрого доступа)

### 3. AI промпты
- Системный промпт обновлен с приоритетом для изображений из документации:
  - **ПРИОРИТЕТ**: Изображения из результатов поиска (`Images:` секция)
  - **ЗАПАСНОЙ ВАРИАНТ**: Внешние изображения (Unsplash, Pexels)

### 4. Формат для AI
Когда поиск находит изображения, они передаются AI в формате:
```
Images:
![Diagram](./product/overview/interpretating.svg)
```

## Пример работы

**Пользователь спрашивает**: "How does real-time translation work?"

1. Семантический поиск находит раздел "How AI Real-Time Translation Works"  
2. В результатах есть изображение `interpretating.svg` с диаграммой процесса
3. AI получает информацию об изображении в секции `Images:`
4. AI включает изображение в ответ: `![](./product/overview/interpretating.svg)`

## Преимущества

- ✅ **Релевантность**: Изображения напрямую связаны с контентом документации
- ✅ **Качество**: Диаграммы и схемы созданы специально для объяснения концепций
- ✅ **Согласованность**: Изображения соответствуют стилю документации
- ✅ **Производительность**: Нет необходимости в внешних API для поиска изображений

## Технические детали

### Структура метаданных в Pinecone
```javascript
{
  text: "содержимое чанка",
  url: "product/overview/how-it-works#speech-recognition", 
  title: "How AI Real-Time Translation Works",
  images: '[{"src":"./interpretating.svg","alt":"","context":"...","relativeUrl":"./product/overview/interpretating.svg"}]',
  has_images: true,
  image_count: 1,
  first_image_url: "./product/overview/interpretating.svg"
}
```

### Файлы изменены
- `scripts/indexDocs.ts`: Добавлена функция `extractImages()` и обновлены интерфейсы
- `api/lib/aiChatLib.ts`: Обновлен парсинг результатов поиска 
- `docs/.vitepress/config/AIConfig.ts`: Обновлены системные промпты

## Тестирование
```bash
# Переиндексация с изображениями
pnpm tsx scripts/indexDocs.ts scripts/indexConfig.ts

# Проверка векторов
pnpm tsx scripts/checkVectors.ts

# Тест извлечения изображений  
pnpm tsx scripts/testImageExtraction.ts
```
