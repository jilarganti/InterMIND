---
title: "Шаблоны"
description: "Nuxt Kit предоставляет набор утилит для работы с шаблонами. Эти функции позволяют генерировать дополнительные файлы во время разработки и сборки."
links:
  - label: Source
    icon: i-simple-icons-github
    to: https://github.com/nuxt/nuxt/blob/main/packages/kit/src/template.ts
    size: xs
---

Шаблоны позволяют генерировать дополнительные файлы во время разработки и сборки. Эти файлы будут доступны в виртуальной файловой системе и могут использоваться в плагинах, макетах, компонентах и т.д. `addTemplate` и `addTypeTemplate` позволяют добавлять шаблоны в приложение Nuxt. `updateTemplates` позволяет регенерировать шаблоны, соответствующие фильтру.

## `addTemplate`

Рендерит заданный шаблон во время сборки в виртуальную файловую систему и опционально на диск в `buildDir` проекта

### Использование

```ts twoslash
import { addTemplate, defineNuxtModule } from '@nuxt/kit'
import { defu } from 'defu'

export default defineNuxtModule({
  setup(options, nuxt) {
    const globalMeta = defu(nuxt.options.app.head, {
      charset: options.charset,
      viewport: options.viewport
    })

    addTemplate({
      filename: 'meta.config.mjs',
      getContents: () => 'export default ' + JSON.stringify({ globalMeta, mixinKey: 'setup' })
    })
  }
})
```

### Тип

```ts twoslash
// @errors: 2391
import type { NuxtTemplate, ResolvedNuxtTemplate } from '@nuxt/schema'
// ---cut---
function addTemplate (template: NuxtTemplate | string): ResolvedNuxtTemplate
```

### Параметры

**template**: Объект шаблона или строка с путем к шаблону. Если передана строка, она будет преобразована в объект шаблона с `src`, установленным в значение строки. Если передан объект шаблона, он должен иметь следующие свойства:

| Свойство   | Тип                                                                 | Обязательно | Описание                                                                                                     |
| ---------- | -------------------------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------- |
| `src`      | `string`                                                             | `false`  | Путь к шаблону. Если `src` не указан, вместо него должен быть предоставлен `getContents`.                         |
| `filename` | `string`                                                             | `false`  | Имя файла шаблона. Если `filename` не указан, он будет сгенерирован из пути `src`. В этом случае опция `src` обязательна. |
| `dst`      | `string`                                                             | `false`  | Путь к файлу назначения. Если `dst` не указан, он будет сгенерирован из пути `filename` и опции `buildDir` nuxt. |
| `options`  | `Options`                                                           | `false`  | Опции для передачи в шаблон.                                                                                |
| `getContents` | `(data: Options) => string \| Promise<string>`{lang="ts"} | `false`  | Функция, которая будет вызвана с объектом `options`. Она должна возвращать строку или промис, который разрешается в строку. Если указан `src`, эта функция будет проигнорирована. |
| `write`    | `boolean`                                                            | `false`  | Если установлено в `true`, шаблон будет записан в файл назначения. В противном случае шаблон будет использоваться только в виртуальной файловой системе. |

### Примеры

#### Создание виртуального файла для runtime плагина

В этом примере мы объединяем объект внутри модуля и используем результат в runtime плагине.

```ts twoslash [module.ts]
import { addTemplate, defineNuxtModule } from '@nuxt/kit'
import { defu } from 'defu'

export default defineNuxtModule({
  setup (options, nuxt) {
    const globalMeta = defu(nuxt.options.app.head, {
      charset: options.charset,
      viewport: options.viewport,
    })

    addTemplate({
      filename: 'meta.config.mjs',
      getContents: () => 'export default ' + JSON.stringify({ globalMeta, mixinKey: 'setup' }),
    })
  },
})
```

В модуле выше мы генерируем виртуальный файл с именем `meta.config.mjs`. В runtime плагине мы можем импортировать его, используя алиас `#build`:

```ts [runtime/plugin.ts]
import { createHead as createServerHead } from '@unhead/vue/server'
import { createHead as createClientHead } from '@unhead/vue/client'
import { defineNuxtPlugin } from '#imports'
// @ts-ignore
import metaConfig from '#build/meta.config.mjs'

export default defineNuxtPlugin((nuxtApp) => {
  const createHead = import.meta.server ? createServerHead : createClientHead
  const head = createHead()
  head.push(metaConfig.globalMeta)

  nuxtApp.vueApp.use(head)
})
```

## `addTypeTemplate`

Рендерит заданный шаблон во время сборки в buildDir проекта, затем регистрирует его как типы.

### Использование

```ts twoslash
import { addTypeTemplate, defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  setup () {
    addTypeTemplate({
      filename: 'types/markdown.d.ts',
      getContents: () => `declare module '*.md' {
  import type { ComponentOptions } from 'vue'
  const Component: ComponentOptions
  export default Component
}`,
    })
  },
})
```

### Тип

```ts
function addTypeTemplate (template: NuxtTypeTemplate | string, context?: { nitro?: boolean, nuxt?: boolean }): ResolvedNuxtTemplate
```

### Параметры

**template**: Объект шаблона или строка с путем к шаблону. Если передана строка, она будет преобразована в объект шаблона с `src`, установленным в значение строки. Если передан объект шаблона, он должен иметь следующие свойства:

| Свойство   | Тип                                                                 | Обязательно | Описание                                                                                                     |
| ---------- | -------------------------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------- |
| `src`      | `string`                                                             | `false`  | Путь к шаблону. Если `src` не указан, вместо него должен быть предоставлен `getContents`.                         |
| `filename` | `string`                                                             | `false`  | Имя файла шаблона. Если `filename` не указано, оно будет сгенерировано из пути `src`. В этом случае опция `src` обязательна. |
| `dst`      | `string`                                                             | `false`  | Путь к файлу назначения. Если `dst` не указан, он будет сгенерирован из пути `filename` и опции `buildDir` nuxt. |
| `options`  | `Options`                                                            | `false`  | Опции для передачи в шаблон.                                                                                |
| `getContents` | `(data: Options) => string \| Promise<string>`{lang="ts"} | `false`  | Функция, которая будет вызвана с объектом `options`. Она должна возвращать строку или промис, который разрешается в строку. Если указан `src`, эта функция будет проигнорирована. |

**context**: Необязательный объект контекста может быть передан для управления тем, где добавляется тип. Если опущен, тип будет добавлен только в контекст Nuxt. Этот объект поддерживает следующие свойства:

| Свойство   | Тип                                                                 | Обязательно | Описание                                                                                                     |
| ---------- | -------------------------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------- |
| `nuxt`     | `boolean`                                                            | `false`  | Если установлено в `true`, тип будет добавлен в контекст Nuxt.                                                   |
| `nitro`    | `boolean`                                                            | `false`  | Если установлено в `true`, тип будет добавлен в контекст Nitro.                                                  |

### Примеры

#### Добавление шаблонов типов в контекст Nitro

По умолчанию добавляет объявления типов только в контекст Nuxt. Чтобы также добавить их в контекст Nitro, установите nitro в true.

```ts twoslash
import { addTypeTemplate, defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  setup () {
    addTypeTemplate({
      filename: 'types/auth.d.ts',
      getContents: () => `declare module '#auth-utils' {
  interface User {
    id: string;
    name: string;
  }

}`,
    }, {
      nitro: true,
    })
  },
})
```

Это позволяет использовать модуль `#auth-utils` в контексте Nitro.

```ts [server/api/auth.ts]
import type { User } from '#auth-utils'

export default eventHandler(() => {
  const user: User = {
    id: '123',
    name: 'John Doe',
  }

  // делаем что-то с пользователем

  return user
})
```

## `addServerTemplate`

Добавляет виртуальный файл, который может быть использован в сборке сервера Nuxt Nitro.

### Использование

```ts twoslash
import { addServerTemplate, defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  setup () {
    addServerTemplate({
      filename: '#my-module/test.mjs',
      getContents () {
        return 'export const test = 123'
      },
    })
  },
})
```

### Тип

```ts twoslash
// @errors: 2391
import type { NuxtServerTemplate } from '@nuxt/schema'
// ---cut---
function addServerTemplate (template: NuxtServerTemplate): NuxtServerTemplate
```

### Параметры

**template**: Объект шаблона. Он должен иметь следующие свойства:

| Свойство      | Тип                                          | Обязательно | Описание                                                                                                        |
| ------------- | ---------------------------------------------| ----------- | --------------------------------------------------------------------------------------------------------------- |
| `filename`    | `string`                                     | `true`      | Имя файла шаблона.                                                                                              |
| `getContents` | `() => string \| Promise<string>`{lang="ts"} | `true`      | Функция, которая будет вызвана с объектом `options`. Она должна возвращать строку или промис, который разрешается в строку. |

### Примеры

### Создание виртуального файла для Nitro

В этом примере мы создаем виртуальный файл, который может быть использован в сборке сервера Nuxt Nitro.

```ts twoslash
import { addServerTemplate, defineNuxtModule } from '@nuxt/kit'

export default defineNuxtModule({
  setup () {
    addServerTemplate({
      filename: '#my-module/test.mjs',
      getContents () {
        return 'export const test = 123'
      },
    })
  },
})
```

А затем в runtime файле

```ts [server/api/test.ts]
import { test } from '#my-module/test.js'

export default eventHandler(() => {
  return test
})
```

## `updateTemplates`

Регенерирует шаблоны, соответствующие фильтру. Если фильтр не предоставлен, все шаблоны будут регенерированы.

### Использование

```ts
import { defineNuxtModule, updateTemplates } from '@nuxt/kit'
import { resolve } from 'pathe'

export default defineNuxtModule({
  setup (options, nuxt) {
    const updateTemplatePaths = [
      resolve(nuxt.options.srcDir, 'pages'),
    ]
    // отслеживаем и перестраиваем список шаблонов маршрутов при изменении одной из страниц
    nuxt.hook('builder:watch', async (event, relativePath) => {
      if (event === 'change') { return }

      const path = resolve(nuxt.options.srcDir, relativePath)
      if (updateTemplatePaths.some(dir => path.startsWith(dir))) {
        await updateTemplates({
          filter: template => template.filename === 'routes.mjs',
        })
      }
    })
  },
})
```

### Тип

```ts
async function updateTemplates (options: UpdateTemplatesOptions): void
```

### Параметры

**options**: Опции для передачи в шаблон. Этот объект может иметь следующее свойство:

| Свойство   | Тип                                                                 | Обязательно | Описание                                                                                                     |
| ---------- | -------------------------------------------------------------------- | -------- | --------------------------------------------------------------------------------------------------------------- |
| `filter`    | `(template: ResolvedNuxtTemplate) => boolean`{lang="ts"} | `false`  | Функция, которая будет вызвана с объектом `template`. Она должна возвращать булево значение, указывающее, должен ли шаблон быть регенерирован. Если `filter` не предоставлен, все шаблоны будут регенерированы. |